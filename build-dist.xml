<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Master PWM-JE build file which is capable of bundline and package every
     architecture I know/support.
     1.) Build all the exectuable jar files
     2.) Build the Windows NSIS setup binaries
     3.) Build the OSX application bundle
     4.) Build the OSX damage file (can only do this on osx)
  -->
<project default="build_all" name="Creates all runnable jars, application bundles, and setup binaries">
    <condition property="isMac">
        <os family="mac" />
    </condition>
	<condition property="isWindows">
	    <os family="windows" />
	</condition>
		
	<target name="build_all" depends="build-jars, build-nsis, build-osx-app-bundles" />
	
	<!-- Build the jar files -->
    <target name="build-jars">
        <property name="version-number" value="0.5.1" />
    	<property name="copyright" value="Copyright (C) 2011 Dave Marotti" />

        <ant antfile="build-jar.xml" target="build-pwmje-jar">
            <property name="version-number" value="${version-number}" />
            <property name="os-platform" value="win32" />
            <property name="os-arch" value="win32" />
        </ant>
        
        <ant antfile="build-jar.xml" target="build-pwmje-jar">
            <property name="version-number" value="${version-number}" />
            <property name="os-platform" value="win32" />
            <property name="os-arch" value="win32_x86_64" />
        </ant>
    
        <ant antfile="build-jar.xml" target="build-pwmje-jar">
            <property name="version-number" value="${version-number}" />
            <property name="os-platform" value="cocoa" />
            <property name="os-arch" value="macosx" />
        </ant>
        
        <ant antfile="build-jar.xml" target="build-pwmje-jar">
            <property name="version-number" value="${version-number}" />
            <property name="os-platform" value="cocoa" />
            <property name="os-arch" value="macosx_x86_64" />
        </ant>
    </target>

	<!-- Build Windows installers -->
	<target name="build-nsis" if="isWindows">
        <taskdef name="nsis"
            classpath="${basedir}/lib/nsisant-1.3.jar"
            classname="com.danielreese.nsisant.Task" />
        <nsis script="NSIS\win32-setup.nsi" path="D:/Program Files (x86)/NSIS">
        	<define name="VERSION" value="${version-number}" />
        </nsis>
	</target>

    <!-- Build MAC-OSX specific bundles -->
    <target name="build-osx-app-bundles">
        <ant antfile="build-osx-bundle.xml" target="build-osx-bundle">
            <property name="version-number" value="${version-number}" />
            <property name="copyright" value="${copyright}" />
            <property name="os-platform" value="cocoa" />
            <property name="os-arch" value="macosx" />
        </ant>
    </target>
    

</project>
